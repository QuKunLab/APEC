
#### If users want to entirely reproduce the figures in APEC paper, please create a new python 3.6.8 environment in anaconda/miniconda, and install APEC in the environment. APEC will install following packages in specific versions:

    numpy==1.16.2
    scipy==1.0.0
    pandas==0.24.2
    matplotlib==3.0.3
    seaborn==0.9.0
    numba==0.43.1
    networkx==2.2
    python-louvain==0.11
    scikit-learn==0.20.0
    MulticoreTsne==0.1
    umap-learn==0.3.8
    rpy2==2.8.5

**(1)** **project01** contains single cell samples from hematopoietic stem cell differentiation project (including HSC, MPP, CMP, GMP, MEP, LMPP, CLP, pDC, and UNK cells), from "Buenrostro, J.D. et al. Integrated Single-Cell Analysis Maps the Continuous Regulatory Landscape of Human Hematopoietic Differentiation. Cell 173, 1535-1548 e1516 (2018)". Users can run **script_for_project01.py** to obtain Fig. 1b, 1d, 3c, and 3d of the APEC paper, as follows:

    python script_for_project01.py -p $project01 -r $reference

where $project01 is the **project01** folder, and $reference is the **reference** folder. The output figures will be placed in $project01/figure/ folder.

**NOTE**: Monocle is very sensitive to the input matrix. For example, when we use different versions of scipy (such as 1.0.0 and 1.2.1), the PCA matrices generated by sklearn will be slightly different (difference < 1.0e-7), and even this small difference will produce completely different shapes of trajectories by monocle. Different versions of many other related libraries/packages in python and R environment will also result in different shapes of trajectories.


**(2)** **project02** contains single cell samples from the forebrain of adult mice, from "Preissl, S. et al. Single-nucleus analysis of accessible chromatin in developing mouse forebrain reveals cell-type-specific transcriptional regulation. Nat Neurosci 21, 432-439 (2018)". Users can run **script_for_project02.py** to obtain Fig. 2a, 2b, and 2e of the APEC paper, as follows:

    python script_for_project02.py -p $project02 -r $reference

where $project02 is the **project02** folder, and $reference is the **reference** folder. The output figures will be placed in $project02/figure/ folder.

If users want to re-plot Fig. 2c, 2d, 2f, and 2g of the APEC paper, they can run **script_python_for_Figure_2c_2d.py** and **script_python_for_Figure_2f_2g.py** **after** the running of "script_for_project02.py", as follows:

    python script_python_for_Figure_2c_2d.py -p $project02
    python script_python_for_Figure_2f_2g.py -p $project02

The output png files "cluster_vs_gene.png" is Fig. 2c, "cluster_pearson_corr.png" is Fig. 2d, "clusters_vs_Excl_types.png" is Fig. 2f, "clusters_vs_Int_types.png" is Fig. 2g. These output figures will be placed in the same folder as the two scripts.


**(3)** **project03** contains single cell samples of the leukemic stem and blast cells of two different patients (SU070 and SU353), from "Schep, A.N., Wu, B., Buenrostro, J.D. & Greenleaf, W.J. chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data. Nat Methods 14, 975-978 (2017)". Users can run **script_for_project03.py** to obtain Fig. S3b of the APEC paper, as follows:

    python script_for_project03.py -p $project03

where $project03 is the **project03** folder. The output figures will be placed in $project03/figure/ folder.
